import{a as I,V as x}from"./Bcodmk3m.js";import{d as b,c as u,t as i,v as f,L as r,A as n,x as g,z as a,B as w,y,M as c,P as M,_ as U,N as D,O as B,Q as P,R as A,U as H}from"./C2T8xcnD.js";import{u as N}from"./BqPtreZo.js";import{t as V,V as z}from"./DzYNW7pl.js";import{V as W}from"./CBmxWw-I.js";import{V as E}from"./DlXRcwIs.js";import"./DFuK27d6.js";const G={class:"text"},O={class:"text bottom"},R=b({__name:"card",props:{card:{},elevation:{},isSelected:{type:Boolean}},emits:["click"],setup(l,{emit:e}){const s=u(()=>{var h;switch((h=t.card)==null?void 0:h.suit){case"Spades":return"♠";case"Hearts":return"♥";case"Diamonds":return"♦";case"Clubs":return"♣";default:return""}}),t=l,d=e,o=()=>{d("click")};return(h,C)=>(i(),f("div",null,[t.card&&t.card.isFaceUp?(i(),r(x,{key:0,width:"100%",class:M(["card",{"color-red":t.card.suit==="Hearts"||t.card.suit==="Diamonds","is-selected":t.isSelected||!1}]),elevation:t.elevation||24,onClick:o},{default:n(()=>[g("div",G,[a(I,{class:"pa-0"},{default:n(()=>[w(y(c(s)),1)]),_:1}),a(I,{class:"pa-0"},{default:n(()=>[w(y(t.card.rank),1)]),_:1})]),g("div",O,[a(I,{class:"pa-0"},{default:n(()=>[w(y(t.card.rank),1)]),_:1}),a(I,{class:"pa-0"},{default:n(()=>[w(y(c(s)),1)]),_:1})])]),_:1},8,["elevation","class"])):t.card&&!t.card.isFaceUp?(i(),r(x,{key:1,width:"100%",class:"card is-face-down",elevation:t.elevation||24,onClick:o},null,8,["elevation"])):(i(),r(x,{key:2,width:"100%",class:"card is-null",elevation:"0",onClick:o}))]))}}),T=U(R,[["__scopeId","data-v-d7931312"]]),K={key:0,class:"card-bundle"},L={key:1,class:"card-bundle"},Q=b({__name:"card-bundle",props:{bundle:{},isSelected:{type:Boolean},selectedCard:{}},emits:["click"],setup(l,{emit:e}){const s=l,t=e,d=o=>{t("click",o)};return(o,h)=>{const C=T;return i(),f("div",null,[s.bundle.length?(i(),f("div",K,[(i(!0),f(D,null,B(s.bundle,(p,k)=>(i(),r(C,{key:p.id,card:p,"is-selected":s.isSelected&&s.selectedCard===p,class:"klondike-card",elevation:k===s.bundle.length-1?10:0,style:P({top:`${k*1}rem`}),onClick:S=>d(p)},null,8,["card","is-selected","elevation","style","onClick"]))),128))])):(i(),f("div",L,[a(C,{card:null,"is-face-up":!1,onClick:h[0]||(h[0]=p=>d(null))})]))])}}}),j=U(Q,[["__scopeId","data-v-7a34be93"]]),q={class:"row"},J={class:"col"},X={class:"col waste"},Y={class:"row"},Z=b({__name:"board",props:{deck:{},fields:{},wastes:{},piles:{},isSelectedField:{type:Boolean},isSelectedWaste:{type:Boolean},selectedFieldIndex:{},selectedCard:{}},emits:["clickDeck","clickEmptyDeck","clickPile","clickBundle","clickWaste"],setup(l,{emit:e}){const s=l,t=e,d=()=>{t("clickDeck")},o=()=>{t("clickEmptyDeck")},h=()=>{t("clickWaste")},C=k=>{t("clickPile",k)},p=(k,S)=>{t("clickBundleCard",k,S)};return(k,S)=>{const m=T,$=j;return i(),f("div",null,[g("div",q,[g("div",J,[s.deck.length?(i(),r(m,{key:0,card:s.deck[s.deck.length-1],"is-face-up":!1,onClick:d},null,8,["card"])):(i(),r(m,{key:1,card:null,"is-face-up":!1,onClick:o}))]),g("div",X,[s.wastes.length?(i(),r(m,{key:0,card:s.wastes[s.wastes.length-1],"is-face-up":!0,"is-selected":s.isSelectedWaste,onClick:h},null,8,["card","is-selected"])):(i(),r(m,{key:1,card:null,"is-face-up":!1}))]),(i(!0),f(D,null,B(s.piles,(F,_)=>(i(),f("div",{key:_,class:"col"},[F.length?(i(),r(m,{key:0,card:F[F.length-1],onClick:v=>C(_)},null,8,["card","onClick"])):(i(),r(m,{key:1,card:null,onClick:v=>C(_)},null,8,["onClick"]))]))),128))]),g("div",Y,[(i(!0),f(D,null,B(s.fields,(F,_)=>(i(),f("div",{key:_,class:"col"},[a($,{bundle:F,"is-selected":s.isSelectedField&&s.selectedFieldIndex===_,"selected-card":s.selectedCard,onClick:v=>p(v,_)},null,8,["bundle","is-selected","selected-card","onClick"])]))),128))])])}}}),ee=U(Z,[["__scopeId","data-v-427232bb"]]),se=["Spades","Hearts","Diamonds","Clubs"],te=A("useKlondike",{state:()=>({deck:[],fields:[],wastes:[],piles:[],isSelectedWaste:!1,isSelectedField:!1,selectedFieldIndex:-1,selectedCard:null}),getters:{isGameClear(){return this.piles.every(l=>l.length===13)}},actions:{start(){this.deck=[];const l=Array.from({length:13},(e,s)=>s+1);se.forEach(e=>{l.forEach(s=>{this.deck.push({suit:e,rank:s,isFaceUp:!1})})}),this.deck.sort(()=>Math.random()-.5),this.fields=Array.from({length:7},(e,s)=>this.deck.splice(0,s+1)),this.fields.forEach(e=>{e[e.length-1].isFaceUp=!0}),this.wastes=[],this.piles=Array.from({length:4},()=>[]),this.isSelectedWaste=!1,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null},draw(){this.wastes.push(this.deck.pop()),this.wastes[this.wastes.length-1].isFaceUp=!0},resetDeck(){this.deck.push(...this.wastes.reverse()),this.deck.forEach(l=>{l.isFaceUp=!1}),this.wastes=[]},selectWaste(){if(this.wastes.length!==0){if(this.isSelectedWaste){this.isSelectedWaste=!1;return}this.isSelectedField||(this.isSelectedWaste=!0,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null)}},selectField(l,e){var s;if(this.isSelectedWaste){if(this.fields[e].length===0){this.fields[e].push(this.wastes.pop()),this.resetSelected();return}const t=this.wastes[this.wastes.length-1],d=this.fields[e][this.fields[e].length-1];if(this.isSuitMatch(t,d)&&t.rank===d.rank-1)this.fields[e].push(this.wastes.pop());else return;this.resetSelected();return}if(this.isSelectedField){if(this.selectedFieldIndex===e){this.resetSelected();return}if(this.fields[e].length===0){this.fields[e].push(...this.fields[this.selectedFieldIndex].splice(this.fields[this.selectedFieldIndex].indexOf(this.selectedCard))),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0),this.resetSelected();return}const t=this.fields[e][this.fields[e].length-1];this.isSuitMatch(this.selectedCard,t)&&((s=this.selectedCard)==null?void 0:s.rank)===t.rank-1&&(this.fields[e].push(...this.fields[this.selectedFieldIndex].splice(this.fields[this.selectedFieldIndex].indexOf(this.selectedCard))),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0),this.resetSelected());return}if(l!==null){if(l.isFaceUp)this.selectedCard=l;else{const t=this.fields[e].find(d=>d.isFaceUp);this.selectedCard=t||null}this.isSelectedWaste=!1,this.isSelectedField=!0,this.selectedFieldIndex=e}},selectPile(l){if(!this.isSelectedField&&!this.isSelectedWaste)return;if(this.isSelectedWaste){const s=this.wastes[this.wastes.length-1];if(this.piles[l].length===0){s.rank===1&&this.piles[l].push(this.wastes.pop()),this.resetSelected();return}else{const t=this.piles[l][this.piles[l].length-1];if(s.suit===t.suit&&s.rank===t.rank+1){this.piles[l].push(this.wastes.pop()),this.resetSelected();return}else return}}const e=this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1];if(e!==void 0)if(this.piles[l].length===0)e.rank===1&&(this.piles[l].push(this.fields[this.selectedFieldIndex].pop()),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0,this.resetSelected()));else{const s=this.piles[l][this.piles[l].length-1];e.suit===s.suit&&e.rank===s.rank+1&&(this.piles[l].push(this.fields[this.selectedFieldIndex].pop()),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0),this.resetSelected())}},isSuitMatch(l,e){return l.suit==="Spades"||l.suit==="Clubs"?e.suit==="Hearts"||e.suit==="Diamonds":e.suit==="Spades"||e.suit==="Clubs"},resetSelected(){this.isSelectedWaste=!1,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null}}}),oe=b({__name:"klondike",setup(l){const e=te(),s=u(()=>e.deck),t=u(()=>e.fields),d=u(()=>e.wastes),o=u(()=>e.piles),h=u(()=>e.selectedFieldIndex),C=u(()=>e.selectedCard),p=u(()=>e.isSelectedField),k=u(()=>e.isSelectedWaste),S=N(),m=u(()=>S.currentTheme.dark?V(S.currentTheme.colors.primary).darken(40).toString():V(S.currentTheme.colors.primary).lighten(40).toString());return e.start(),($,F)=>{const _=ee;return i(),r(W,{class:"pa-0"},{default:n(()=>[a(W,{class:"board",style:P({"background-color":c(m)})},{default:n(()=>[a(_,{deck:c(s),fields:c(t),wastes:c(d),piles:c(o),"selected-field-index":c(h),"selected-card":c(C),"is-selected-field":c(p),"is-selected-waste":c(k),onClickDeck:c(e).draw,onClickEmptyDeck:c(e).resetDeck,onClickPile:c(e).selectPile,onClickWaste:c(e).selectWaste,onClickBundleCard:c(e).selectField},null,8,["deck","fields","wastes","piles","selected-field-index","selected-card","is-selected-field","is-selected-waste","onClickDeck","onClickEmptyDeck","onClickPile","onClickWaste","onClickBundleCard"])]),_:1},8,["style"]),a(W,null,{default:n(()=>[a(z,null,{default:n(()=>[a(E,null,{default:n(()=>[a(H,{onClick:F[0]||(F[0]=v=>c(e).start())},{default:n(()=>[w(" Reset ")]),_:1})]),_:1}),a(E,null,{default:n(()=>[w(y(c(e).isGameClear?"Game Clear!":""),1)]),_:1})]),_:1})]),_:1})]),_:1})}}});export{oe as default};
