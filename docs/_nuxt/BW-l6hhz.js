import{a as y,V as D}from"./_DOjBdyo.js";import{d as I,c as _,t as i,v as u,M as o,A as r,x as F,z as n,B as w,y as g,N as c,Q as P,_ as b,O as $,P as U,R as M,S as A,W as H}from"./BXbOwoH-.js";import{V as B}from"./CUn2wrsh.js";import{a as N,V}from"./CJfBOKuY.js";const z={class:"text"},G={class:"text bottom"},O=I({__name:"card",props:{card:{},elevation:{},isSelected:{type:Boolean}},emits:["click"],setup(t,{emit:e}){const s=_(()=>{var h;switch((h=l.card)==null?void 0:h.suit){case"Spades":return"♠";case"Hearts":return"♥";case"Diamonds":return"♦";case"Clubs":return"♣";default:return""}}),l=t,d=e,a=()=>{d("click")};return(h,C)=>(i(),u("div",null,[l.card&&l.card.isFaceUp?(i(),o(D,{key:0,width:"100%",class:P(["card",{"color-red":l.card.suit==="Hearts"||l.card.suit==="Diamonds","is-selected":l.isSelected||!1}]),elevation:l.elevation||24,onClick:a},{default:r(()=>[F("div",z,[n(y,{class:"pa-0"},{default:r(()=>[w(g(c(s)),1)]),_:1}),n(y,{class:"pa-0"},{default:r(()=>[w(g(l.card.rank),1)]),_:1})]),F("div",G,[n(y,{class:"pa-0"},{default:r(()=>[w(g(l.card.rank),1)]),_:1}),n(y,{class:"pa-0"},{default:r(()=>[w(g(c(s)),1)]),_:1})])]),_:1},8,["elevation","class"])):l.card&&!l.card.isFaceUp?(i(),o(D,{key:1,width:"100%",class:"card is-face-down",elevation:l.elevation||24,onClick:a},null,8,["elevation"])):(i(),o(D,{key:2,width:"100%",class:"card is-null",elevation:"0",onClick:a}))]))}}),E=b(O,[["__scopeId","data-v-dd214a0b"]]),R={key:0,class:"card-bundle"},T={key:1,class:"card-bundle"},K=I({__name:"card-bundle",props:{bundle:{},isSelected:{type:Boolean},selectedCard:{}},emits:["click"],setup(t,{emit:e}){const s=t,l=e,d=a=>{l("click",a)};return(a,h)=>{const C=E;return i(),u("div",null,[s.bundle.length?(i(),u("div",R,[(i(!0),u($,null,U(s.bundle,(f,k)=>(i(),o(C,{key:f.id,card:f,"is-selected":s.isSelected&&s.selectedCard===f,class:"klondike-card",elevation:k===s.bundle.length-1?10:0,style:M({top:`${k*1}rem`}),onClick:v=>d(f)},null,8,["card","is-selected","elevation","style","onClick"]))),128))])):(i(),u("div",T,[n(C,{card:null,"is-face-up":!1,onClick:h[0]||(h[0]=f=>d(null))})]))])}}}),L=b(K,[["__scopeId","data-v-7a34be93"]]),Q={class:"row"},j={class:"col"},q={class:"col waste"},J={class:"row"},X=I({__name:"board",props:{deck:{},fields:{},wastes:{},piles:{},isSelectedField:{type:Boolean},isSelectedWaste:{type:Boolean},selectedFieldIndex:{},selectedCard:{}},emits:["clickDeck","clickEmptyDeck","clickPile","clickBundle","clickWaste"],setup(t,{emit:e}){const s=t,l=e,d=()=>{l("clickDeck")},a=()=>{l("clickEmptyDeck")},h=()=>{l("clickWaste")},C=k=>{l("clickPile",k)},f=(k,v)=>{l("clickBundleCard",k,v)};return(k,v)=>{const p=E,W=L;return i(),u("div",null,[F("div",Q,[F("div",j,[s.deck.length?(i(),o(p,{key:0,card:s.deck[s.deck.length-1],"is-face-up":!1,onClick:d},null,8,["card"])):(i(),o(p,{key:1,card:null,"is-face-up":!1,onClick:a}))]),F("div",q,[s.wastes.length?(i(),o(p,{key:0,card:s.wastes[s.wastes.length-1],"is-face-up":!0,"is-selected":s.isSelectedWaste,onClick:h},null,8,["card","is-selected"])):(i(),o(p,{key:1,card:null,"is-face-up":!1}))]),(i(!0),u($,null,U(s.piles,(S,m)=>(i(),u("div",{key:m,class:"col"},[S.length?(i(),o(p,{key:0,card:S[S.length-1],onClick:x=>C(m)},null,8,["card","onClick"])):(i(),o(p,{key:1,card:null,onClick:x=>C(m)},null,8,["onClick"]))]))),128))]),F("div",J,[(i(!0),u($,null,U(s.fields,(S,m)=>(i(),u("div",{key:m,class:"col"},[n(W,{bundle:S,"is-selected":s.isSelectedField&&s.selectedFieldIndex===m,"selected-card":s.selectedCard,onClick:x=>f(x,m)},null,8,["bundle","is-selected","selected-card","onClick"])]))),128))])])}}}),Y=b(X,[["__scopeId","data-v-427232bb"]]),Z=["Spades","Hearts","Diamonds","Clubs"],ee=A("useKlondike",{state:()=>({deck:[],fields:[],wastes:[],piles:[],isSelectedWaste:!1,isSelectedField:!1,selectedFieldIndex:-1,selectedCard:null}),getters:{isGameClear(){return this.piles.every(t=>t.length===13)}},actions:{start(){this.deck=[];const t=Array.from({length:13},(e,s)=>s+1);Z.forEach(e=>{t.forEach(s=>{this.deck.push({suit:e,rank:s,isFaceUp:!1})})}),this.deck.sort(()=>Math.random()-.5),this.fields=Array.from({length:7},(e,s)=>this.deck.splice(0,s+1)),this.fields.forEach(e=>{e[e.length-1].isFaceUp=!0}),this.wastes=[],this.piles=Array.from({length:4},()=>[]),this.isSelectedWaste=!1,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null},draw(){this.wastes.push(this.deck.pop()),this.wastes[this.wastes.length-1].isFaceUp=!0},resetDeck(){this.deck.push(...this.wastes),this.deck.forEach(t=>{t.isFaceUp=!1}),this.wastes=[]},selectWaste(){if(this.wastes.length!==0){if(this.isSelectedWaste){this.isSelectedWaste=!1;return}this.isSelectedField||(this.isSelectedWaste=!0,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null)}},selectField(t,e){var s,l;if(this.isSelectedWaste){if(this.fields[e].length===0){this.wastes[this.wastes.length-1].rank===13&&this.fields[e].push(this.wastes.pop()),this.resetSelected();return}const d=this.wastes[this.wastes.length-1],a=this.fields[e][this.fields[e].length-1];if(this.isSuitMatch(d,a)&&d.rank===a.rank-1)this.fields[e].push(this.wastes.pop());else return;this.resetSelected();return}if(this.isSelectedField){if(this.selectedFieldIndex===e){this.resetSelected();return}if(this.fields[e].length===0){((s=this.selectedCard)==null?void 0:s.rank)===13&&(this.fields[e].push(...this.fields[this.selectedFieldIndex].splice(this.fields[this.selectedFieldIndex].indexOf(this.selectedCard))),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0)),this.resetSelected();return}const d=this.fields[e][this.fields[e].length-1];this.isSuitMatch(this.selectedCard,d)&&((l=this.selectedCard)==null?void 0:l.rank)===d.rank-1&&(this.fields[e].push(...this.fields[this.selectedFieldIndex].splice(this.fields[this.selectedFieldIndex].indexOf(this.selectedCard))),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0),this.resetSelected());return}if(t!==null){if(t.isFaceUp)this.selectedCard=t;else{const d=this.fields[e].find(a=>a.isFaceUp);this.selectedCard=d||null}this.isSelectedWaste=!1,this.isSelectedField=!0,this.selectedFieldIndex=e}},selectPile(t){if(!this.isSelectedField&&!this.isSelectedWaste)return;if(this.isSelectedWaste){const s=this.wastes[this.wastes.length-1];if(this.piles[t].length===0){s.rank===1&&this.piles[t].push(this.wastes.pop()),this.resetSelected();return}else{const l=this.piles[t][this.piles[t].length-1];if(s.suit===l.suit&&s.rank===l.rank+1){this.piles[t].push(this.wastes.pop()),this.resetSelected();return}else return}}const e=this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1];if(e!==void 0)if(this.piles[t].length===0)e.rank===1&&(this.piles[t].push(this.fields[this.selectedFieldIndex].pop()),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0,this.resetSelected()));else{const s=this.piles[t][this.piles[t].length-1];e.suit===s.suit&&e.rank===s.rank+1&&(this.piles[t].push(this.fields[this.selectedFieldIndex].pop()),this.resetSelected())}},isSuitMatch(t,e){return t.suit==="Spades"||t.suit==="Clubs"?e.suit==="Hearts"||e.suit==="Diamonds":e.suit==="Spades"||e.suit==="Clubs"},resetSelected(){this.isSelectedWaste=!1,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null}}}),se=I({__name:"klondike",setup(t){const e=ee(),s=_(()=>e.deck),l=_(()=>e.fields),d=_(()=>e.wastes),a=_(()=>e.piles),h=_(()=>e.selectedFieldIndex),C=_(()=>e.selectedCard),f=_(()=>e.isSelectedField),k=_(()=>e.isSelectedWaste);return e.start(),(v,p)=>{const W=Y;return i(),o(B,{class:"pa-0"},{default:r(()=>[n(B,{class:"board"},{default:r(()=>[n(W,{deck:c(s),fields:c(l),wastes:c(d),piles:c(a),"selected-field-index":c(h),"selected-card":c(C),"is-selected-field":c(f),"is-selected-waste":c(k),onClickDeck:c(e).draw,onClickEmptyDeck:c(e).resetDeck,onClickPile:c(e).selectPile,onClickWaste:c(e).selectWaste,onClickBundleCard:c(e).selectField},null,8,["deck","fields","wastes","piles","selected-field-index","selected-card","is-selected-field","is-selected-waste","onClickDeck","onClickEmptyDeck","onClickPile","onClickWaste","onClickBundleCard"])]),_:1}),n(B,null,{default:r(()=>[n(N,null,{default:r(()=>[n(V,null,{default:r(()=>[n(H,{onClick:p[0]||(p[0]=S=>c(e).start())},{default:r(()=>[w("Reset")]),_:1})]),_:1}),n(V,null,{default:r(()=>[w(g(c(e).isGameClear?"Game Clear!":""),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),de=b(se,[["__scopeId","data-v-f1defb0d"]]);export{de as default};
