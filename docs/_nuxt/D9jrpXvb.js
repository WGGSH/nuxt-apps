import{a as I,V as W}from"./DBiQfQ3t.js";import{d as b,c as u,t as i,v as f,L as o,A as r,x as w,z as n,B as g,y,M as c,P as M,_ as $,N as D,O as B,Q as P,R as A,U as H}from"./B0p4roPO.js";import{u as N}from"./Cl7cS9Rs.js";import{t as V}from"./Begke6kS.js";import{V as x}from"./BRzB-ZQZ.js";import{a as z,V as E}from"./9gaUl96v.js";const G={class:"text"},O={class:"text bottom"},R=b({__name:"card",props:{card:{},elevation:{},isSelected:{type:Boolean}},emits:["click"],setup(t,{emit:e}){const s=u(()=>{var h;switch((h=l.card)==null?void 0:h.suit){case"Spades":return"♠";case"Hearts":return"♥";case"Diamonds":return"♦";case"Clubs":return"♣";default:return""}}),l=t,d=e,a=()=>{d("click")};return(h,C)=>(i(),f("div",null,[l.card&&l.card.isFaceUp?(i(),o(W,{key:0,width:"100%",class:M(["card",{"color-red":l.card.suit==="Hearts"||l.card.suit==="Diamonds","is-selected":l.isSelected||!1}]),elevation:l.elevation||24,onClick:a},{default:r(()=>[w("div",G,[n(I,{class:"pa-0"},{default:r(()=>[g(y(c(s)),1)]),_:1}),n(I,{class:"pa-0"},{default:r(()=>[g(y(l.card.rank),1)]),_:1})]),w("div",O,[n(I,{class:"pa-0"},{default:r(()=>[g(y(l.card.rank),1)]),_:1}),n(I,{class:"pa-0"},{default:r(()=>[g(y(c(s)),1)]),_:1})])]),_:1},8,["elevation","class"])):l.card&&!l.card.isFaceUp?(i(),o(W,{key:1,width:"100%",class:"card is-face-down",elevation:l.elevation||24,onClick:a},null,8,["elevation"])):(i(),o(W,{key:2,width:"100%",class:"card is-null",elevation:"0",onClick:a}))]))}}),T=$(R,[["__scopeId","data-v-d7931312"]]),K={key:0,class:"card-bundle"},L={key:1,class:"card-bundle"},Q=b({__name:"card-bundle",props:{bundle:{},isSelected:{type:Boolean},selectedCard:{}},emits:["click"],setup(t,{emit:e}){const s=t,l=e,d=a=>{l("click",a)};return(a,h)=>{const C=T;return i(),f("div",null,[s.bundle.length?(i(),f("div",K,[(i(!0),f(D,null,B(s.bundle,(p,k)=>(i(),o(C,{key:p.id,card:p,"is-selected":s.isSelected&&s.selectedCard===p,class:"klondike-card",elevation:k===s.bundle.length-1?10:0,style:P({top:`${k*1}rem`}),onClick:F=>d(p)},null,8,["card","is-selected","elevation","style","onClick"]))),128))])):(i(),f("div",L,[n(C,{card:null,"is-face-up":!1,onClick:h[0]||(h[0]=p=>d(null))})]))])}}}),j=$(Q,[["__scopeId","data-v-7a34be93"]]),q={class:"row"},J={class:"col"},X={class:"col waste"},Y={class:"row"},Z=b({__name:"board",props:{deck:{},fields:{},wastes:{},piles:{},isSelectedField:{type:Boolean},isSelectedWaste:{type:Boolean},selectedFieldIndex:{},selectedCard:{}},emits:["clickDeck","clickEmptyDeck","clickPile","clickBundle","clickWaste"],setup(t,{emit:e}){const s=t,l=e,d=()=>{l("clickDeck")},a=()=>{l("clickEmptyDeck")},h=()=>{l("clickWaste")},C=k=>{l("clickPile",k)},p=(k,F)=>{l("clickBundleCard",k,F)};return(k,F)=>{const m=T,U=j;return i(),f("div",null,[w("div",q,[w("div",J,[s.deck.length?(i(),o(m,{key:0,card:s.deck[s.deck.length-1],"is-face-up":!1,onClick:d},null,8,["card"])):(i(),o(m,{key:1,card:null,"is-face-up":!1,onClick:a}))]),w("div",X,[s.wastes.length?(i(),o(m,{key:0,card:s.wastes[s.wastes.length-1],"is-face-up":!0,"is-selected":s.isSelectedWaste,onClick:h},null,8,["card","is-selected"])):(i(),o(m,{key:1,card:null,"is-face-up":!1}))]),(i(!0),f(D,null,B(s.piles,(S,_)=>(i(),f("div",{key:_,class:"col"},[S.length?(i(),o(m,{key:0,card:S[S.length-1],onClick:v=>C(_)},null,8,["card","onClick"])):(i(),o(m,{key:1,card:null,onClick:v=>C(_)},null,8,["onClick"]))]))),128))]),w("div",Y,[(i(!0),f(D,null,B(s.fields,(S,_)=>(i(),f("div",{key:_,class:"col"},[n(U,{bundle:S,"is-selected":s.isSelectedField&&s.selectedFieldIndex===_,"selected-card":s.selectedCard,onClick:v=>p(v,_)},null,8,["bundle","is-selected","selected-card","onClick"])]))),128))])])}}}),ee=$(Z,[["__scopeId","data-v-427232bb"]]),se=["Spades","Hearts","Diamonds","Clubs"],te=A("useKlondike",{state:()=>({deck:[],fields:[],wastes:[],piles:[],isSelectedWaste:!1,isSelectedField:!1,selectedFieldIndex:-1,selectedCard:null}),getters:{isGameClear(){return this.piles.every(t=>t.length===13)}},actions:{start(){this.deck=[];const t=Array.from({length:13},(e,s)=>s+1);se.forEach(e=>{t.forEach(s=>{this.deck.push({suit:e,rank:s,isFaceUp:!1})})}),this.deck.sort(()=>Math.random()-.5),this.fields=Array.from({length:7},(e,s)=>this.deck.splice(0,s+1)),this.fields.forEach(e=>{e[e.length-1].isFaceUp=!0}),this.wastes=[],this.piles=Array.from({length:4},()=>[]),this.isSelectedWaste=!1,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null},draw(){this.wastes.push(this.deck.pop()),this.wastes[this.wastes.length-1].isFaceUp=!0},resetDeck(){this.deck.push(...this.wastes),this.deck.forEach(t=>{t.isFaceUp=!1}),this.wastes=[]},selectWaste(){if(this.wastes.length!==0){if(this.isSelectedWaste){this.isSelectedWaste=!1;return}this.isSelectedField||(this.isSelectedWaste=!0,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null)}},selectField(t,e){var s,l;if(this.isSelectedWaste){if(this.fields[e].length===0){this.wastes[this.wastes.length-1].rank===13&&this.fields[e].push(this.wastes.pop()),this.resetSelected();return}const d=this.wastes[this.wastes.length-1],a=this.fields[e][this.fields[e].length-1];if(this.isSuitMatch(d,a)&&d.rank===a.rank-1)this.fields[e].push(this.wastes.pop());else return;this.resetSelected();return}if(this.isSelectedField){if(this.selectedFieldIndex===e){this.resetSelected();return}if(this.fields[e].length===0){((s=this.selectedCard)==null?void 0:s.rank)===13&&(this.fields[e].push(...this.fields[this.selectedFieldIndex].splice(this.fields[this.selectedFieldIndex].indexOf(this.selectedCard))),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0)),this.resetSelected();return}const d=this.fields[e][this.fields[e].length-1];this.isSuitMatch(this.selectedCard,d)&&((l=this.selectedCard)==null?void 0:l.rank)===d.rank-1&&(this.fields[e].push(...this.fields[this.selectedFieldIndex].splice(this.fields[this.selectedFieldIndex].indexOf(this.selectedCard))),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0),this.resetSelected());return}if(t!==null){if(t.isFaceUp)this.selectedCard=t;else{const d=this.fields[e].find(a=>a.isFaceUp);this.selectedCard=d||null}this.isSelectedWaste=!1,this.isSelectedField=!0,this.selectedFieldIndex=e}},selectPile(t){if(!this.isSelectedField&&!this.isSelectedWaste)return;if(this.isSelectedWaste){const s=this.wastes[this.wastes.length-1];if(this.piles[t].length===0){s.rank===1&&this.piles[t].push(this.wastes.pop()),this.resetSelected();return}else{const l=this.piles[t][this.piles[t].length-1];if(s.suit===l.suit&&s.rank===l.rank+1){this.piles[t].push(this.wastes.pop()),this.resetSelected();return}else return}}const e=this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1];if(e!==void 0)if(this.piles[t].length===0)e.rank===1&&(this.piles[t].push(this.fields[this.selectedFieldIndex].pop()),this.fields[this.selectedFieldIndex].length>0&&(this.fields[this.selectedFieldIndex][this.fields[this.selectedFieldIndex].length-1].isFaceUp=!0,this.resetSelected()));else{const s=this.piles[t][this.piles[t].length-1];e.suit===s.suit&&e.rank===s.rank+1&&(this.piles[t].push(this.fields[this.selectedFieldIndex].pop()),this.resetSelected())}},isSuitMatch(t,e){return t.suit==="Spades"||t.suit==="Clubs"?e.suit==="Hearts"||e.suit==="Diamonds":e.suit==="Spades"||e.suit==="Clubs"},resetSelected(){this.isSelectedWaste=!1,this.isSelectedField=!1,this.selectedFieldIndex=-1,this.selectedCard=null}}}),re=b({__name:"klondike",setup(t){const e=te(),s=u(()=>e.deck),l=u(()=>e.fields),d=u(()=>e.wastes),a=u(()=>e.piles),h=u(()=>e.selectedFieldIndex),C=u(()=>e.selectedCard),p=u(()=>e.isSelectedField),k=u(()=>e.isSelectedWaste),F=N(),m=u(()=>F.currentTheme.dark?V(F.currentTheme.colors.primary).darken(40).toString():V(F.currentTheme.colors.primary).lighten(40).toString());return e.start(),(U,S)=>{const _=ee;return i(),o(x,{class:"pa-0"},{default:r(()=>[n(x,{class:"board",style:P({"background-color":c(m)})},{default:r(()=>[n(_,{deck:c(s),fields:c(l),wastes:c(d),piles:c(a),"selected-field-index":c(h),"selected-card":c(C),"is-selected-field":c(p),"is-selected-waste":c(k),onClickDeck:c(e).draw,onClickEmptyDeck:c(e).resetDeck,onClickPile:c(e).selectPile,onClickWaste:c(e).selectWaste,onClickBundleCard:c(e).selectField},null,8,["deck","fields","wastes","piles","selected-field-index","selected-card","is-selected-field","is-selected-waste","onClickDeck","onClickEmptyDeck","onClickPile","onClickWaste","onClickBundleCard"])]),_:1},8,["style"]),n(x,null,{default:r(()=>[n(z,null,{default:r(()=>[n(E,null,{default:r(()=>[n(H,{onClick:S[0]||(S[0]=v=>c(e).start())},{default:r(()=>[g(" Reset ")]),_:1})]),_:1}),n(E,null,{default:r(()=>[g(y(c(e).isGameClear?"Game Clear!":""),1)]),_:1})]),_:1})]),_:1})]),_:1})}}});export{re as default};
